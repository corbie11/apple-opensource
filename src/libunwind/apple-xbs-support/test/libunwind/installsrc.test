RUN: rm -rf %t
RUN: mkdir -p %t/dest
RUN: make -C %src_root installsrc "SRCROOT=%t/dest" "RC_ProjectName=libunwind" 2>&1 \
RUN: | grep 'libunwind => apple-xbs-support/libunwind.mk'

# Verify that we got all the subdirs we wanted, but not others.

RUN: stat %t/dest/Makefile
RUN: stat %t/dest/apple-xbs-support
RUN: stat %t/dest/libunwind
RUN: ! stat %t/dest/llvm
RUN: ! stat %t/dest/clang
RUN: ! stat %t/dest/libcxx


RUN: mkdir -p %t/Sim
RUN: make -C %src_root installsrc "SRCROOT=%t/Sim" "RC_ProjectName=libunwind_Sim"

# Verify that we got all the subdirs we wanted, but not others.

RUN: stat %t/Sim/Makefile
RUN: stat %t/Sim/apple-xbs-support
RUN: stat %t/Sim/libunwind
RUN: ! stat %t/Sim/llvm
RUN: ! stat %t/Sim/clang
RUN: ! stat %t/Sim/libcxx

# Test variant trains.
RUN: mkdir -p %t/variant/dest %t/variant/Sim
RUN: make -C %src_root installsrc "SRCROOT=%t/variant/dest" "RC_ProjectName=Variant_libunwind" 2>&1 \
RUN: | grep 'Variant_libunwind => apple-xbs-support/libunwind.mk'
RUN: stat %t/variant/dest/Makefile
RUN: stat %t/variant/dest/apple-xbs-support
RUN: stat %t/variant/dest/libunwind
RUN: ! stat %t/variant/dest/llvm
RUN: ! stat %t/variant/dest/clang
RUN: ! stat %t/variant/dest/libcxx
RUN: make -C %src_root installsrc "SRCROOT=%t/variant/Sim" "RC_ProjectName=Variant_libunwind_Sim" 2>&1 \
RUN: | grep 'Variant_libunwind_Sim => apple-xbs-support/libunwind_Sim.mk'
RUN: stat %t/variant/Sim/Makefile
RUN: stat %t/variant/Sim/apple-xbs-support
RUN: stat %t/variant/Sim/libunwind
RUN: ! stat %t/variant/Sim/llvm
RUN: ! stat %t/variant/Sim/clang
RUN: ! stat %t/variant/Sim/libcxx
